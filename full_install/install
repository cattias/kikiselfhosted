sudo lvextend -l +100%FREE /dev/mapper/ubuntu--vg-ubuntu--lv -r

sudo apt install nfs-common
sudo apt install ceph

netplan
fstab and mount

curl -sSLf https://get.k0s.sh | sudo sh

sudo k0s install controller --single
sudo k0s start
sudo k0s kubeconfig admin > .kube/config

sudo snap install kubectl --classic

kubectl create namespace argocd
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml

kubectl patch svc argocd-server -n argocd -p '{"spec": {"type": "NodePort"}}'

wget argocd release
chmod a+x argocd
sudo mv argocd /usr/local/bin

argocd admin initial-password -n argocd


/etc/systemd/system.conf
[Manager]
DefaultLimitNOFILE=1048576

sudo systemctl edit k0scontroller.service
[Service]
LimitNOFILE=1048576

sudo systemctl daemon-reload
sudo systemctl restart k0scontroller.service

sudo vi /etc/sysctl.d/99-inotify-limits.conf
# Increase the maximum number of inotify instances for a user
fs.inotify.max_user_instances = 1024
# Increase the maximum number of inotify watches for a user
fs.inotify.max_user_watches = 524288

sudo sysctl --system



create namespaces
create secrets

ArgoCD ignore diff patch ?

plex
  extraEnv:
    // plex.tv/claim
    PLEX_CLAIM: "claim-xVbzFJXTJsx_Md-mexyy"
Remote : disable
Custom server access URLs : plex.attias.io:443,https://plex.attias.io:443


Accept subnets in tailscale
Verify pihole DNS records against IP from services

kubectl patch svc argocd-server -n argocd -p '{"spec": {"type": "ClusterIP"}}'
